MAIN	START	1000
	JSUB	STKINIT
	JSUB	RDREC
	JSUB	WRREC

RDREC	LDX	ZERO
RLOOP	TD	INPUT
	JEQ	RLOOP
	LDA	ZERO
	RD	INPUT
	COMP	ASEN
	JEQ	EXIT
	STA	@TOP
	JSUB	PUSH
	TIX	MAXLEN
	JLT	RLOOP
EXIT	STX	LENGTH
	JSUB	WRREC	 

STKINIT	LDA	#STACK
	STA	TOP
	RSUB

PUSH	LDA	TOP
	ADD	#3
	STA	TOP
	RSUB

POP	LDA	TOP
	SUB	#3
	STA	TOP
	RSUB

WRREC	LDX	ZERO
WLOOP	TD	OUTPUT
	JEQ	WLOOP
	JSUB	POP
	LDA	@TOP
	WD	OUTPUT
	TIX	LENGTH
	JLT	WLOOP


INPUT	BYTE	0
OUTPUT	BYTE	1
MAXLEN	WORD	30
LENGTH	RESW	1
ZERO	WORD	0
ASEN	WORD	10
TOP	RESW	1
STACK	RESW	10000
